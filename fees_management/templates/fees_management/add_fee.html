{% extends 'base.html' %}
{% block content %}
{% load static %}
<div style="margin-bottom: -20px">
	  <div class="" style="margin-left: 10px">
    <a class="btn-floating waves-effect waves-light title-back-btn" onclick="window.history.back();" onmouseover="" style="cursor: pointer;">
      <img src="/media/icons8-left-64.png" style="height: 45px;width: 45px; margin-bottom:5px;">  </a>
     <span class="grey-text text-darken-2" style="font-size: 1.64rem;line-height: 52px; margin-left: 50px;">Add Fee</span>
    </div>
  
</div>
<hr>
         
    <div class="col s12 m12 l12 padding-right-0 " style="padding-bottom:10%;">

    <div class="table">
        <div class="card grey lighten-5 card_align_left">
          <div class="card-content white-text list_view">
            <!--Student list view-->
            	
            	<div style="display: inline;">
            	
            	<form action="{% url 'fees_management:add_fee' %}" method="post" enctype="multipart/form-data">
            				<!-- <select id="id_class" name="student_class" required select class="disabled_toggle form-control" style="width: 200px"> -->
                            <option value="" selected disabled>Class</option>
                            {% for class in section_class %}
			            	<!-- <option value="{{class}}"> --><input type="checkbox" name="class" value="{{class}}"> {{class}}<br></option>
			            	        {% endfor %}
                          	<!-- </select> -->

                          	<!-- <input type="submit" name="submit" value="take" id="take"> -->
                         <input type="text" placeholder="Name/description" name="desc" id="description" class="form-control" style="width:300px;">&nbsp;
                         <input type="number" placeholder="Amount" name="amount" class="form-control" id="amount" style="width:300px;">
                        &nbsp;
                        <select id="id_cycle" name="cycle" required select class="disabled_toggle form-control" style="width: 300px"> 
                            <option value="" selected disabled>Cycle</option>
                            <option name="cycle" value="1">Annual</option>
                            <option value="2" name="cycle">Half Yearly</option>
                            <option value="3" name="cycle">Quarterly</option>
                            <option value="4" name="cycle">Monthly</option>
                        </select>
                        <br>
                        <input type="button" id="add" name="submit" value="Add" class="form-control" style="width: 100px ">
                 </form>

                 <script type="text/javascript">
                    

                    $(".add").click(function(){
                      var url = "{% url 'fees_management:add_fee' %}";
                      var formData = [];
                      var classes = [];
                      formData.push($('#description').val());
                      formData.push($('#id_cycle').val());
                      formData.push($('#amount').val());
                        $('input[name="class"]:checked').each(function() {
                           classes.push(this.value);
                        });
                        console.log(formData);
                        console.log(classes);
                        var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
                     $.ajax({
                      url: url,
                      type: "POST",
                      //contentType: false,
                      //processData: false,
                      enctype:"multipart/form-data",
                      csrftoken:csrftoken,
                      data: {
                          'formData' : formData,
                          'classes' : classes,
                      },
                      success: function (response) {
                          console.log(response);
                          alert("Successfully Added!");
                          // location.reload();
                      },
                      error: function (response) {
                          console.log(response);
                      },
                    });//End of ajax request
                    });      

                 </script>
            	</div>
            </div>    		
       		</div>
       		</div>
         <script>//this script for filter the searchbox data of list institute form
             
             // $(".clickable-row").click(function(){
             //  var mid = $(this).attr('data-id');
             //  console.log(mid);
             //  alert(mid);
             //  // window.location.href = "{% url 'dashboard:student_profile' id=12 %}";
             //  // window.location="http://127.0.0.1:8000/dashboard/student/?id";
//             });
            </script>

{% endblock %}